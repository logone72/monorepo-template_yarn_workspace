#!/bin/bash

# 오류가 발생하면 즉시 종료
set -e

echo "╔═══════════════════════════════════════════════════════════════════════════╗"
echo "║                                                                           ║"
echo "║   ███████╗██████╗  ██████╗ ███╗   ██╗████████╗    ██╗   ██╗████████╗██╗   ║"
echo "║   ██╔════╝██╔══██╗██╔═══██╗████╗  ██║╚══██╔══╝    ██║   ██║╚══██╔══╝██║   ║"
echo "║   █████╗  ██████╔╝██║   ██║██╔██╗ ██║   ██║       ██║   ██║   ██║   ██║   ║"
echo "║   ██╔══╝  ██╔══██╗██║   ██║██║╚██╗██║   ██║       ██║   ██║   ██║   ██║   ║"
echo "║   ██║     ██║  ██║╚██████╔╝██║ ╚████║   ██║       ╚██████╔╝   ██║   ██║   ║"
echo "║   ╚═╝     ╚═╝  ╚═╝ ╚═════╝ ╚═╝  ╚═══╝   ╚═╝        ╚═════╝    ╚═╝   ╚═╝   ║"
echo "║                                                                           ║"
echo "║                     🚀 유틸 빌드를 시작합니다... 🚀                       ║"
echo "║                                                                           ║"
echo "╚═══════════════════════════════════════════════════════════════════════════╝"

print_step() {
  echo "┌────────────────────────────────────────────────────────────┐"
  echo "│ 🔔 $1"
  echo "└────────────────────────────────────────────────────────────┘"
}

print_step "🧹 이전 빌드 파일을 정리합니다..."
yarn run clean

print_step "📝 타입스크립트 선언 파일을 생성합니다..."
yarn run build:tsc

print_step "✨ 타입 선언 파일을 이쁘게 합니다..."
prettier dist/@types --write

print_step "🔨 자바스크립트 파일을 빌드합니다..."
yarn run build:js


echo
echo "╔═══════════════════════════════════════════════════════════════════════════╗"
echo "║                                                                           ║"
echo "║                     ✨ 유틸 빌드가 완료되었습니다! ✨                     ║"
echo "║                                                                           ║"
echo "║                    모든 파일이 성공적으로 빌드되었습니다                  ║"
echo "║                                                                           ║"
echo "╚═══════════════════════════════════════════════════════════════════════════╝"